{% extends "admin_base.html" %}


{% block maincontents %}
  <div class="row">
    <div class="col-md-12">
      <div class="grid simple">
        <div class="grid-title no-border">
          <h4>Add <span class="semi-bold">Employee</span></h4>
          <div class="grid-body no-border">
            <form class="form-no-horizontal-spacing" novalidate="novalidate" id="form-organisation-emp" method="post" action="/admin/organisation/{{ org.id }}/employees">
              <div class="row column-seperation">
                <div class="col-md-6">
                  <h4>Basic Information </h4>
                  <div class="row form-row">
                    <div class="col-md-5">
                      <div class="input-with-icon  right">
                        <input name="first_name_add_organisation" id="first_name_add_organisation" value="" type="text" class="form-control" placeholder="First Name" maxlength="30">
                      </div>
                    </div>
                    <div class="col-md-7">
                      <div class="input-with-icon  right">
                        <input name="last_name_add_organisation" id="last_name_add_organisation" value="" type="text" class="form-control" placeholder="Last Name" maxlength="30">
                      </div>
                    </div>
                  </div>
                  <div class="row form-row">
                    <div class="col-md-12">
                      <div class="input-with-icon  right">
                        <input name="email_add_organisation" id="email_add_organisation" value="" type="text" class="form-control" placeholder="email@address.com" minlength="3" maxlength="30">
                      </div>
                    </div>
                  </div>
                  <div class="row form-row">
                    <div class="col-md-7">
                      <div class="input-with-icon  right">
                        <div class="input-append success date  col-lg-6 no-padding">
                          <input type="text" type="text" placeholder="Date of Birth" class="form-control" value="" id="date_of_birth_add_organisation" name="date_of_birth_add_organisation" >
                          <span class="add-on"><span class="arrow"></span><i class="fa fa-th"></i></span> </div>
                      </div>
                    </div>
                    <div class="col-md-5">
                      <div class="radio form-group">
                        <input id="male" type="radio" name="gender" value="male" checked="checked">
                        <label for="male">Male</label>
                        <input id="female" type="radio" name="gender" value="female">
                        <label for="female">Female</label>
                      </div>
                    </div>
                  </div>
                  <div class="row form-row">
                    <div class="col-md-12 form-group">
                      <select name="role" id="role" class="select2 form-control">
                        <option value="ORG_CM">CM (Center Manager)</option>
                        <option value="ORG_BM">BM (Branch Manager)</option>
                        <option value="ORG_AM">AM (Area Manager)</option>
                        <option value="ORG_RM">RM (Regional Manager)</option>
                        <option value="ORG_SH">SH (State Head)</option>
                        <option value="ORG_ZH">ZH (Zonal Head)</option>
                        <option value="ORG_VP">VP (Vice President)</option>
                        <option value="ORG_CXO">CXO</option>
                      </select>
                    </div>
                  </div>
                  <div class="row form-row">
                    <div class="col-md-12 form-group">
                      <select name="branch" id="branch" class="select2 form-control">
                        {% for branch in branches %}
                          <option value="{{ branch.id }}">{{ branch.state.state_name }}-{{ branch.region.region_name }}-{{ branch.area.area_name }}-{{ branch.branch_name }}</option>
                        {% endfor %}
                      </select>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <h4>Postal Information</h4>
                  <div class="row form-row">
                    <div class="col-md-12">
                      <div class="input-with-icon  right">
                        <input name="address_add_org_emp" id="address_add_org_emp" value="" type="text" class="form-control" placeholder="Address">
                      </div>
                    </div>
                  </div>
                  <div class="row form-row">
                    <div class="col-md-6 form-group">
                      <div class="input-with-icon  right">
                        <select name="country_add_organisation" id="postal_country"  class="form-control select2" placeholder="Country"></select>
                      </div>
                    </div>
                    <div class="col-md-6 form-group">
                      <div class="input-with-icon  right">
                        <select name="state_add_organisation" id="postal_state" class="form-control select2" placeholder="State"></select>
                      </div>
                    </div>
                  </div>
                  <div class="row form-row">
                    <div class="col-md-6">
                      <div class="input-with-icon  right">
                        <input name="city_add_organisation" value="" id="city_add_organisation" type="text" class="form-control" placeholder="City" maxlength="30">
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="input-with-icon  right">
                        <input name="postal_code_add_organisation" value="" id="postal_code_add_organisation" type="text" class="form-control" placeholder="Postal Code" minlength="5" maxlength="6">
                      </div>
                    </div>
                  </div>
                  <div class="row form-row">
                    <div class="col-md-4">
                      <div class="input-with-icon  right">
                        <input name="tele_code_add_organisation" value="" id="tele_code_add_organisation" type="text" class="form-control" placeholder="+91" minlength="1" maxlength="2">
                      </div>
                    </div>
                    <div class="col-md-8">
                      <div class="input-with-icon  right">
                        <input name="teleno_add_organisation" value="" id="teleno_add_organisation" type="text" class="form-control" placeholder="Phone Number" maxlength="10">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-actions">
                <div class="pull-right">
                  <button class="btn btn-small btn-danger btn-cons" type="submit">Add Employee</button>
                  <button class="btn btn-small btn-white btn-cons cancel-button" type="reset" value="clear">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
      <div class="col-md-12">
          <div class="grid simple ">
              <div class="grid-title">
                  <h4> <span class="semi-bold">Employees</span></h4>
              </div>
              <div class="grid-body ">
                  <table class="table table-hover table-condensed" id="organisation-emp-table">
                      <thead>
                      <tr >
                          <th style="width:1%" >#</th>
                          <th style="width:20%">EMP ID</th>
                          <th style="width:23%">NAME</th>
                          <th style="width:25%">EMAIL</th>
                          <th style="width:22%">ROLES</th>
                      </tr>
                      </thead>
                      <tbody>
                      {% for emp in employees %}
                          <tr>
                              <td class="v-align-middle">{{ loop.index }}</td>
                              <td class="v-align-middle">{{ emp.id}}</td>
                              <td class="v-align-middle">{{ emp.first_name }}</td>
                              <td><span class="muted">{{ emp.email }}</span></td>
                              <td><span class="muted">{{ emp.roles }}</span></td>
                          </tr>
                      {% endfor %}
                      </tbody>
                  </table>
              </div>
          </div>
      </div>
  </div>
{% endblock %}


{% block js_scripts %}
  <script src="{{ url_for('static', filename='js/countries.js') }}" type="text/javascript"></script>
  <script type="text/javascript">
    $(document).ready(function(){
      populateCountries("postal_country", "postal_state");
      $("#postal_country").select2();
      $("#postal_state").select2();
      $("#role").select2({
        placeholder: "Select a ROLE",
        allowClear: true
      });
      $("#branch").select2({
        placeholder: "Select a ROLE",
        allowClear: true
      });
      $("#state").select2({
        placeholder: "Select a ROLE",
        allowClear: true
      });
      $("#area").select2({
        placeholder: "Select a ROLE",
        allowClear: true
      });
      $("#region").select2({
        placeholder: "Select a ROLE",
        allowClear: true
      });

      $(':input','#form-organisation')
          .not(':button, :submit, :reset, :hidden')
          .val('')
          .removeAttr('checked')
          .removeAttr('selected');

      $('#form-organisation-emp').validate({
        errorElement: 'span',
        errorClass: 'error',
        focusInvalid: false,
        ignore: "",
        rules: {
          first_name_add_organisation: {
            minlength: 2,
            maxlength: 30,
            required: true,
            lettersonly: true
          },
          last_name_add_organisation: {
            minlength: 2,
            maxlength: 30,
            required: true,
            lettersonly: true
          },
          email_add_organisation: {
            email: true,
            minlength: 3,
            maxlength: 30,
            required: true
          },
          address_add_org_emp: {
            minlength: 2,
            required: true
          },
          city_add_organisation: {
            minlength: 2,
            maxlength: 30,
            required: true,
            lettersonly: true
          },
          postal_code_add_organisation: {
            number:true,
            minlength: 5,
            maxlength: 6,
            required: true
          },
          teleno_add_organisation: {
            number:true,
            minlength: 10,
            maxlength: 10,
            required: true
          },
          tele_code_add_organisation: {
            minlength: 1,
            maxlength: 2,
            number:true,
            required: true
          }
        },
        invalidHandler: function (event, validator) {
          //display error alert on form submit
        },
        errorPlacement: function (error, element) { // render error placement for each input type
          var icon = $(element).parent('.input-with-icon').children('i');
          var parent = $(element).parent('.input-with-icon');
          icon.removeClass('fa fa-check').addClass('fa fa-exclamation');
          parent.removeClass('success-control').addClass('error-control');
        },
        highlight: function (element) { // hightlight error inputs
          var parent = $(element).parent();
          parent.removeClass('success-control').addClass('error-control');
        },
        unhighlight: function (element) { // revert the change done by hightlight

        },
        success: function (label, element) {
          var icon = $(element).parent('.input-with-icon').children('i');
          var parent = $(element).parent('.input-with-icon');
          icon.removeClass("fa fa-exclamation").addClass('fa fa-check');
          parent.removeClass('error-control').addClass('success-control');
        },
        submitHandler: function (form) {
          form.submit();
        }
      });
      $('.cancel-button').click(function(){
          location.href = '/admin/organisation/{{ org.id }}/dashboard';
      });
      $('.input-append.date').datepicker({
        autoclose: true,
        todayHighlight: true
      });
    });
  </script>
{% endblock %}